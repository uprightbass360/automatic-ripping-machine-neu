# All-in-one deployment: ARM + UI + Transcoder on a single machine
# Copy to .env and adjust values before running: docker compose up -d

# --- Version Pinning ---
ARM_VERSION=latest
UI_VERSION=latest
TRANSCODER_VERSION=latest

# --- ARM Ripper ---
ARM_UID=1000
ARM_GID=1000
TZ=America/New_York

# Host paths
ARM_MUSIC_PATH=/home/arm/music
ARM_LOGS_PATH=/home/arm/logs
ARM_MEDIA_PATH=/home/arm/media
ARM_CONFIG_PATH=/etc/arm/config

# Ports
ARM_PORT=8080
UI_PORT=8888
TRANSCODER_PORT=5000

# CPU pinning (leave ARM cores free for ripping)
ARM_CPUSET=2,3,4,5,6,7

# Optical drives (uncomment and adjust)
# ARM_DEVICE_0=/dev/sr0
# ARM_DEVICE_1=/dev/sr1

# --- Transcoder ---
LOG_LEVEL=INFO

# GPU encoder: nvenc_h265, vaapi_h265, amf_h265, qsv_h265, x265, x264
VIDEO_ENCODER=nvenc_h265
VIDEO_QUALITY=22
AUDIO_ENCODER=copy
SUBTITLE_MODE=all

HANDBRAKE_PRESET=H.265 NVENC 1080p
HANDBRAKE_PRESET_4K=H.265 NVENC 2160p 4K
HANDBRAKE_PRESET_FILE=

DELETE_SOURCE=true
OUTPUT_EXTENSION=mkv
MOVIES_SUBDIR=movies
TV_SUBDIR=tv
AUDIO_SUBDIR=audio

MAX_CONCURRENT=1
STABILIZE_SECONDS=60
MINIMUM_FREE_SPACE_GB=10
MAX_RETRY_COUNT=3

# Local scratch for transcoding (fast SSD recommended)
TRANSCODER_WORK_PATH=./work
TRANSCODER_PRESET_PATH=./presets

# --- Transcoder Integration ---
# ARM_TRANSCODER_URL defaults to http://arm-transcoder:5000/webhook/arm
# Override for remote transcoder (e.g. http://192.168.0.92:5000/webhook/arm)
# ARM_TRANSCODER_URL=

# --- Authentication ---
# Shared secret for ARM â†’ transcoder webhook calls.
# Generate with: openssl rand -hex 32
WEBHOOK_SECRET=
API_KEYS=
REQUIRE_API_AUTH=false
TRANSCODER_API_KEY=
